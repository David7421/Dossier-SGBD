-------------------
-- SPECIFICATION --
-------------------

CREATE OR REPLACE PACKAGE GESTIONCB
IS
	PROCEDURE BACKUP;
END;










----------
-- BODY --
----------

CREATE OR REPLACE PACKAGE BODY GESTIONCB
IS

	PROCEDURE BACKUP

	BEGIN

		-- UTILISATEURS
		INSERT INTO UTILISATEUR@CBB.DBL (LOGIN, PASSWORD, 'OK') SELECT * FROM UTILISATEUR WHERE TOKEN IS NULL;
		UPDATE UTILISATEUR SET TOKEN = 'OK';

		-- EVALUATIONS
		INSERT INTO EVALUATION@CBB.DBL (IDFILM, LOGIN, COTE, AVIS, DATEEVAL, 'OK') SELECT * FROM UTILISATEUR WHERE TOKEN = 'KO';
		UPDATE EVALUATION SET TOKEN = 'OK';

		COMMIT;

	END;

END;
